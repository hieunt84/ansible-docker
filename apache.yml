---
- name: Deploy web server apache on docker using ansible for dev environment
  hosts: dev
  become: true
  tasks:

  - name: remove httpd
    yum:
      name: httpd
      state: removed
  - name: Install python pip
    yum:
      name: python-pip
      state: present  
      
  - name: install docker
    yum:
      name: docker
      state: present

  - name: Start docker
    service:
      name: docker
      state: started
      enabled: yes
  - name: Install docker-py python module
    pip:
      name: docker-py
      state: present
      
  - name: Start the container
    docker_container:
      name: happyit
      image: httpd
      state: started
      published_ports:
        - 0.0.0.0:80:80

  - name: allow http service
    command:
      cmd: firewall-cmd --permanent --add-service=http
      
  - name: reload firewalld
    command:
      cmd: firewall-cmd --reload
  
  - name: check status
    command:
      cmd: systemctl status docker
    register: result
      
  - name: show result on screen 
    debug: var=result.stdout_lines
...

